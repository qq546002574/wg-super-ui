<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>wg-editor-plus 导出功能测试</title>
  <link rel="stylesheet" href="../node_modules/element-ui/lib/theme-chalk/index.css">
  <style>
    body {
      font-family: 'Microsoft YaHei', Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f5f5;
    }
    
    .test-container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .test-header {
      text-align: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #eee;
    }
    
    .test-header h1 {
      color: #333;
      margin-bottom: 10px;
    }
    
    .test-header p {
      color: #666;
      font-size: 14px;
    }
    
    .editor-section {
      margin-bottom: 30px;
    }
    
    .section-title {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 15px;
      color: #333;
      border-left: 4px solid #409eff;
      padding-left: 10px;
    }
    
    .config-panel {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 6px;
      margin-bottom: 20px;
    }
    
    .config-row {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .config-label {
      width: 120px;
      font-weight: bold;
      color: #333;
    }
    
    .config-input {
      flex: 1;
      margin-left: 10px;
    }
    
    .test-buttons {
      text-align: center;
      margin: 20px 0;
    }
    
    .test-button {
      margin: 0 10px;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    
    .test-button.primary {
      background: #409eff;
      color: white;
    }
    
    .test-button.success {
      background: #67c23a;
      color: white;
    }
    
    .test-button.warning {
      background: #e6a23c;
      color: white;
    }
    
    .test-button.danger {
      background: #f56c6c;
      color: white;
    }
    
    .test-button:hover {
      opacity: 0.8;
      transform: translateY(-1px);
    }
    
    .sample-content {
      background: #f0f9ff;
      padding: 15px;
      border-radius: 6px;
      border-left: 4px solid #409eff;
      margin-bottom: 20px;
    }
    
    .feature-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .feature-item {
      background: white;
      border: 1px solid #eee;
      border-radius: 6px;
      padding: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .feature-item h4 {
      margin: 0 0 10px 0;
      color: #409eff;
    }
    
    .feature-item ul {
      margin: 0;
      padding-left: 20px;
    }
    
    .feature-item li {
      margin-bottom: 5px;
      color: #666;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="test-container">
      <div class="test-header">
        <h1>🚀 wg-editor-plus 导出功能测试</h1>
        <p>测试富文本编辑器的导出功能，包括 HTML、PDF、DOCX 等格式</p>
      </div>

      <!-- 配置面板 -->
      <div class="editor-section">
        <div class="section-title">📋 导出配置</div>
        <div class="config-panel">
          <div class="config-row">
            <label class="config-label">页面格式:</label>
            <el-select v-model="exportConfig.format" class="config-input">
              <el-option label="A4" value="a4"></el-option>
              <el-option label="A3" value="a3"></el-option>
              <el-option label="Letter" value="letter"></el-option>
            </el-select>
          </div>
          
          <div class="config-row">
            <label class="config-label">页面方向:</label>
            <el-select v-model="exportConfig.orientation" class="config-input">
              <el-option label="竖向" value="portrait"></el-option>
              <el-option label="横向" value="landscape"></el-option>
            </el-select>
          </div>
          
          <div class="config-row">
            <label class="config-label">字体大小:</label>
            <el-input-number v-model="exportConfig.fontSize" :min="8" :max="24" class="config-input"></el-input-number>
          </div>
          
          <div class="config-row">
            <label class="config-label">字体族:</label>
            <el-select v-model="exportConfig.fontFamily" class="config-input">
              <el-option label="微软雅黑" value="Microsoft YaHei, Arial, sans-serif"></el-option>
              <el-option label="宋体" value="SimSun, serif"></el-option>
              <el-option label="Arial" value="Arial, sans-serif"></el-option>
              <el-option label="Times New Roman" value="Times New Roman, serif"></el-option>
            </el-select>
          </div>
        </div>
      </div>

      <!-- 编辑器 -->
      <div class="editor-section">
        <div class="section-title">✏️ 富文本编辑器</div>
        
        <div class="sample-content">
          <h4>💡 提示</h4>
          <p>您可以在下方编辑器中输入内容，然后使用工具栏中的导出按钮测试各种导出功能。</p>
          <p>新增了 DOCX 导出功能，采用先转 PDF 再转换成 DOCX 的方式。</p>
        </div>
        
        <wg-editor-plus 
          ref="editor"
          :initial-content="sampleContent"
          :export-styles="exportConfig"
          @change="handleContentChange"
          style="min-height: 400px; border: 1px solid #ddd; border-radius: 6px;">
        </wg-editor-plus>
      </div>

      <!-- 测试按钮 -->
      <div class="test-buttons">
        <button class="test-button primary" @click="loadSampleContent">
          📝 加载示例内容
        </button>
        <button class="test-button success" @click="testAllExports">
          🚀 测试所有导出
        </button>
        <button class="test-button warning" @click="clearContent">
          🗑️ 清空内容
        </button>
        <button class="test-button danger" @click="resetConfig">
          🔄 重置配置
        </button>
      </div>

      <!-- 功能说明 -->
      <div class="editor-section">
        <div class="section-title">📖 功能说明</div>
        <div class="feature-list">
          <div class="feature-item">
            <h4>🆕 新增功能</h4>
            <ul>
              <li>DOCX 导出（先转PDF再转换）</li>
              <li>优化的打印样式</li>
              <li>可配置的导出选项</li>
              <li>改进的用户界面</li>
            </ul>
          </div>
          
          <div class="feature-item">
            <h4>📄 支持格式</h4>
            <ul>
              <li>HTML - 完整网页格式</li>
              <li>PDF - 高质量打印格式</li>
              <li>DOCX - Microsoft Word 格式</li>
              <li>TXT - 纯文本格式</li>
            </ul>
          </div>
          
          <div class="feature-item">
            <h4>⚙️ 配置选项</h4>
            <ul>
              <li>页面格式和方向</li>
              <li>字体大小和字体族</li>
              <li>页边距设置</li>
              <li>打印样式优化</li>
            </ul>
          </div>
          
          <div class="feature-item">
            <h4>🎨 样式特性</h4>
            <ul>
              <li>表格边框和间距</li>
              <li>图片自适应缩放</li>
              <li>代码块语法高亮</li>
              <li>分页控制优化</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 引入依赖 -->
  <script src="../node_modules/vue/dist/vue.js"></script>
  <script src="../node_modules/element-ui/lib/index.js"></script>
  <script src="../dist/lib/wg-component-library.umd.min.js"></script>
  
  <script>
    new Vue({
      el: '#app',
      data() {
        return {
          exportConfig: {
            format: 'a4',
            orientation: 'portrait',
            fontSize: 12,
            fontFamily: 'Microsoft YaHei, Arial, sans-serif',
            margin: {
              top: 20,
              right: 20,
              bottom: 20,
              left: 20
            }
          },
          sampleContent: {
            html: `
              <h1>wg-editor-plus 导出功能测试</h1>
              
              <h2>📋 测试内容概述</h2>
              <p>这是一个用于测试 <strong>wg-editor-plus</strong> 组件导出功能的示例文档。包含了各种富文本元素来验证导出效果。</p>
              
              <h2>📊 表格测试</h2>
              <table>
                <thead>
                  <tr>
                    <th>功能</th>
                    <th>格式</th>
                    <th>状态</th>
                    <th>说明</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>HTML导出</td>
                    <td>.html</td>
                    <td>✅ 已支持</td>
                    <td>完整保留样式</td>
                  </tr>
                  <tr>
                    <td>PDF导出</td>
                    <td>.pdf</td>
                    <td>✅ 已支持</td>
                    <td>高质量打印格式</td>
                  </tr>
                  <tr>
                    <td>DOCX导出</td>
                    <td>.docx</td>
                    <td>🆕 新增</td>
                    <td>先转PDF再转换</td>
                  </tr>
                  <tr>
                    <td>文本导出</td>
                    <td>.txt</td>
                    <td>✅ 已支持</td>
                    <td>纯文本格式</td>
                  </tr>
                </tbody>
              </table>
              
              <h2>📝 文本格式测试</h2>
              <p>这里测试各种文本格式：</p>
              <ul>
                <li><strong>粗体文本</strong></li>
                <li><em>斜体文本</em></li>
                <li><u>下划线文本</u></li>
                <li><s>删除线文本</s></li>
                <li><code>行内代码</code></li>
                <li><mark>高亮文本</mark></li>
              </ul>
              
              <h2>💻 代码块测试</h2>
              <pre><code>// JavaScript 示例代码
function exportDocument(format) {
  switch(format) {
    case 'html':
      return exportAsHTML();
    case 'pdf': 
      return exportAsPDF();
    case 'docx':
      return exportAsDocx();
    default:
      throw new Error('不支持的格式');
  }
}</code></pre>
              
              <h2>💬 引用测试</h2>
              <blockquote>
                <p>这是一个引用文本示例。引用通常用于突出显示重要信息或引用他人的话语。</p>
                <p>— wg-editor-plus 开发团队</p>
              </blockquote>
              
              <h2>🔗 链接测试</h2>
              <p>访问 <a href="https://github.com" target="_blank">GitHub</a> 查看更多开源项目。</p>
              
              <h2>📋 有序列表</h2>
              <ol>
                <li>首先分析现有功能</li>
                <li>然后设计新的导出方案</li>
                <li>接着实现PDF转DOCX功能</li>
                <li>最后进行测试和优化</li>
              </ol>
              
              <h2>✅ 总结</h2>
              <p>通过这个测试文档，我们可以验证 wg-editor-plus 组件的各种导出功能是否正常工作。新增的 DOCX 导出功能采用了先转 PDF 再转换的方式，确保了格式的兼容性和样式的保持。</p>
            `,
            text: '',
            json: null
          }
        }
      },
      methods: {
        handleContentChange(content) {
          console.log('内容变化:', content);
        },
        
        loadSampleContent() {
          this.$refs.editor.editor.commands.setContent(this.sampleContent.html);
          this.$message.success('示例内容已加载');
        },
        
        async testAllExports() {
          try {
            this.$message.info('开始测试所有导出功能...');
            
            // 测试HTML导出
            await this.$refs.editor.exportAsHTML();
            await this.delay(1000);
            
            // 测试文本导出  
            await this.$refs.editor.exportAsText();
            await this.delay(1000);
            
            // 测试PDF导出
            await this.$refs.editor.exportAsPDF();
            await this.delay(1000);
            
            // 测试DOCX导出
            await this.$refs.editor.exportAsDocx();
            
            this.$message.success('所有导出测试完成！');
          } catch (error) {
            this.$message.error('导出测试失败: ' + error.message);
          }
        },
        
        clearContent() {
          this.$refs.editor.editor.commands.clearContent();
          this.$message.success('内容已清空');
        },
        
        resetConfig() {
          this.exportConfig = {
            format: 'a4',
            orientation: 'portrait',
            fontSize: 12,
            fontFamily: 'Microsoft YaHei, Arial, sans-serif',
            margin: {
              top: 20,
              right: 20,
              bottom: 20,
              left: 20
            }
          };
          this.$message.success('配置已重置');
        },
        
        delay(ms) {
          return new Promise(resolve => setTimeout(resolve, ms));
        }
      }
    });
  </script>
</body>
</html>